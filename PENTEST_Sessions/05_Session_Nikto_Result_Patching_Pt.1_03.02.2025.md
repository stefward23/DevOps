## 03/02/2025


## Nikto

### Time: 3.5 Hours

## Resolving issues reported by nikto

## Example of issue: /192168.tar.bz2: Potentially interesting backup/cert file found. . 

See: https://cwe.mitre.org/data/definitions/530.html + /192.168.cer: Potentially interesting backup/cert file found. . See: https://cwe.mitre.org/data/definitions/530.html

## Resolution 

## Manually Test with Curl or Wget:

Try to access a file using a web request:

curl -I http://your-server.com/backup.tar.bz2

If the response is 200 OK, the file is accessible. If you get 403 Forbidden or 404 Not Found, access is restricted or the file doesn’t exist.
In the nginx.conf file, We added the following.


![image](https://github.com/user-attachments/assets/b537ae15-758c-49b7-a223-ba057fa43929)


To resolve, Added the line to /etc/nginx/conf.d/default.conf on the webserver.
![image](https://github.com/user-attachments/assets/0b0e0b39-b36e-4d48-88cd-3f6e179fa9e9)

}

Results:


![image](https://github.com/user-attachments/assets/c1b16d3d-48a6-4593-9701-fec65c87e3d8)


Reran Nikto Scan:

![image](https://github.com/user-attachments/assets/c7bad1d5-00bc-40e5-9cde-f68503008944)


MIME type sniffing is when a browser tries to guess the type of a file it receives if the server doesn’t explicitly tell it what the file is. This can be a problem when dealing with file uploads.

Why is it a security risk?
Let’s say a website allows users to upload images, and an attacker uploads a file that looks like an image but actually contains harmful JavaScript code.

If the server doesn’t properly label the file as an image (by setting the correct Content-Type), the browser might “sniff” the file, decide it’s actually HTML or JavaScript, and execute it. This could lead to a Cross-Site Scripting (XSS) attack, where the attacker’s malicious code runs in another user’s browser.


To resolve, Added the line to /etc/nginx/conf.d/default.conf on the webserver.

Reloaded nginx

```
nginx -s reload
```
![image](https://github.com/user-attachments/assets/32325a07-3f3a-496f-8354-edb43a650023)

Tested retreiving headers after

![image](https://github.com/user-attachments/assets/b4c5e9cf-b292-4be5-977e-6089ab0ce805)

Content-Type still showed as application/pdf even with no-sniff enabled.

This happens because nginx has a mime.typeS file thats used by default if no Content type rule is added.

Removed application/pdf line from the mime.types file.

![image](https://github.com/user-attachments/assets/a092a3f4-eddd-4940-9c40-fc5dfdea56c3)

Now, When we attempted to view a pdf document on the site, it would be downloaded and not read in the browser.

X-Frame-Options header is not present

This header prevents clickjacking attacks, where an attacker embeds your site in an invisible <iframe> to trick users into interacting with it unknowingly.

To resolve, Added the line to /etc/nginx/conf.d/default.conf on the webserver

![image](https://github.com/user-attachments/assets/2629a04f-e64f-4ef4-ae35-0b9995af4624)





